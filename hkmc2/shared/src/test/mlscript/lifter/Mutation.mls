:lift
:js


let xs = []
//│ xs = []

fun foo() =
  let x = 1
  fun bar() = x
  xs.push(bar)
  set x = 2

:expect 2
foo()
xs.0()
//│ = 2


let xs = []
//│ xs = []

// :sjs
fun foo() =
  let x
  fun bar() = x
  xs.push(bar)
  x = 2

:expect 2
foo()
xs.0()
//│ = 2


fun foo() =
  let x
  fun bar() =
    x = 2
  [bar, () => x]

:expect 2
let b_x = foo()
b_x.0()
b_x.1()
//│ = 2
//│ b_x = [[function], [function]]


:sjs
fun foo() =
  fun bar() =
    let x
    x
  bar
//│ JS (unsanitized):
//│ let bar3, foo3;
//│ bar3 = function bar() {
//│   let x;
//│   x = undefined;
//│   return x
//│ };
//│ foo3 = function foo() {
//│   return bar3
//│ };


