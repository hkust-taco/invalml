:js

data class Numb(n: Int)

:e
fun process(e) =
  if e is
    Numb(n) and n > 0 then n
    Numb(m) then n
//│ ╔══[ERROR] Name not found: n
//│ ║  l.9: 	    Numb(m) then n
//│ ╙──     	                 ^


:re
process(Numb(-10))
//│ ═══[RUNTIME ERROR] Error: MLscript call unexpectedly returned `undefined`, the forbidden value.

fun process(e, n) =
  if e is
    Numb(n) and n > 0 then n
    Numb(m) then n + m

process(Numb(0), 10)
process(Numb(-1), 10)
process(Numb(1), 10)
//│ = 1


// class Vec(xs: Array[Numb | Vec]) // Array is not available
data abstract class Vec[out T](n: Int)
data class Cons[out T](head: T, tail: Vec[T]) extends Vec[T]
object Nil extends Vec[Nothing]

data class Pair[A, B](a: A, b: B)

:e
fun process(e) =
  if e is
    Pair(Numb(n), Numb(m)) then Numb(n + m)
    Pair(Vec(xs), Vec(ys)) then n
    Pair(Vec(n),  Numb(n)) then n
    Pair(Numb(n), Vec(n))  then n
//│ ╔══[ERROR] Name not found: n
//│ ║  l.41: 	    Pair(Vec(xs), Vec(ys)) then n
//│ ╙──      	                                ^


// * FIXME should warn, be rejected, or compare both values for equality
fun process(e) =
  if e is
    Pair(Numb(n), Numb(n)) then n

process(Pair(Numb(1), Numb(2)))
//│ = 2


