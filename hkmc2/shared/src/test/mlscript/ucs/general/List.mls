:js

import "../../../mlscript-compile/Stack.mls"
import "../../../mlscript-compile/Option.mls"

open Stack
open Option { Some, None }


fun length(xs) = if xs is
  Nil then 0
  Cons(_, xs) then 1 + length(xs)

length of Nil
//│ = 0

length of 1 :: 2 :: Nil
//│ = 2

:re
length of ()
//│ ═══[RUNTIME ERROR] Error: match error


fun map(f, xs) = if xs is
  Nil then Nil
  Cons(x, xs) then Cons(f(x), map(f, xs))


fun findFirst(f, xs) =
  if xs is
    Nil then None
    Cons(x, _) and f(x) then Some(x)
    Cons(_, xs) then findFirst(f, xs)

findFirst of _ > 2, Nil
//│ = None

findFirst of _ > 2, 1 :: 2 :: 3 :: 4 :: Nil
//│ = Some(3)

findFirst of _ > 2, 1 :: 2 :: 4 :: 3 :: Nil
//│ = Some(4)


fun findFirst(f, xs) =
  if xs is
    Nil then None
    Cons(x, _) and
      f(x) then Some(x)
    Cons(_, xs) then findFirst(f, xs)

findFirst of _ > 2, Nil
//│ = None

findFirst of _ > 2, 1 :: 2 :: 3 :: 4 :: Nil
//│ = Some(3)

findFirst of _ > 2, 1 :: 2 :: 4 :: 3 :: Nil
//│ = Some(4)


fun findFirst(f, xs) =
  if
    xs is
      Nil then None
      Cons(x, _) and
        f(x) then Some(x)
      Cons(_, xs) then findFirst(f, xs)

findFirst of _ > 2, Nil
//│ = None

findFirst of _ > 2, 1 :: 2 :: 3 :: 4 :: Nil
//│ = Some(3)

findFirst of _ > 2, 1 :: 2 :: 4 :: 3 :: Nil
//│ = Some(4)

