:js


class Foo[A]
class Bar[B]
class Baz


fun foo[A](using Foo[A], A) = 42

using Foo[Baz] = new Foo


// FIXME: error message refers to `A`

:e
:re
foo[Baz]
//│ ╔══[ERROR] Cannot query instance of type Baz (type parameter A) for call: 
//│ ║  l.18: 	foo[Baz]
//│ ║        	^^^^^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.9: 	fun foo[A](using Foo[A], A) = 42
//│ ║       	                         ^
//│ ╙── Missing instance: Expected: Baz (type parameter A); Available: Foo[Baz]
//│ ═══[RUNTIME ERROR] Error: Function 'foo' expected 2 arguments but got 1

:e
:re
foo
//│ ╔══[ERROR] Cannot query instance of type ‹unspecified› (type parameter A) for call: 
//│ ║  l.30: 	foo
//│ ║        	^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.9: 	fun foo[A](using Foo[A], A) = 42
//│ ║       	                         ^
//│ ╙── Illegal query for an unspecified type variable A.
//│ ═══[RUNTIME ERROR] Error: Function 'foo' expected 2 arguments but got 1


using Baz = new Baz

:todo
foo
//│ ╔══[ERROR] Cannot query instance of type ‹unspecified› (type parameter A) for call: 
//│ ║  l.44: 	foo
//│ ║        	^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.9: 	fun foo[A](using Foo[A], A) = 42
//│ ║       	                         ^
//│ ╙── Illegal query for an unspecified type variable A.
//│ ═══[RUNTIME ERROR] Error: Function 'foo' expected 2 arguments but got 1


fun foo[A](using Foo[A])(using A) = 42

:todo
foo
//│ ╔══[ERROR] Cannot query instance of type ‹unspecified› (type parameter A) for call: 
//│ ║  l.58: 	foo
//│ ║        	^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.55: 	fun foo[A](using Foo[A])(using A) = 42
//│ ║        	                               ^
//│ ╙── Illegal query for an unspecified type variable A.
//│ ═══[RUNTIME ERROR] Error: Function expected 1 argument but got 0


fun foo[A](using A)(using Foo[A]) = 42

:todo
foo
//│ ╔══[ERROR] Cannot query instance of type ‹unspecified› (type parameter A) for call: 
//│ ║  l.72: 	foo
//│ ║        	^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.69: 	fun foo[A](using A)(using Foo[A]) = 42
//│ ║        	                 ^
//│ ╙── Illegal query for an unspecified type variable A.
//│ ═══[RUNTIME ERROR] Error: Function 'foo' expected 1 argument but got 0


using Foo[Bar[Baz]] = new Foo

:e
:re
foo
//│ ╔══[ERROR] Cannot query instance of type ‹unspecified› (type parameter A) for call: 
//│ ║  l.87: 	foo
//│ ║        	^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.69: 	fun foo[A](using A)(using Foo[A]) = 42
//│ ║        	                 ^
//│ ╙── Illegal query for an unspecified type variable A.
//│ ═══[RUNTIME ERROR] Error: Function 'foo' expected 1 argument but got 0

using Bar[Baz] = new Bar

:e
:re
foo
//│ ╔══[ERROR] Cannot query instance of type ‹unspecified› (type parameter A) for call: 
//│ ║  l.101: 	foo
//│ ║         	^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.69: 	fun foo[A](using A)(using Foo[A]) = 42
//│ ║        	                 ^
//│ ╙── Illegal query for an unspecified type variable A.
//│ ═══[RUNTIME ERROR] Error: Function 'foo' expected 1 argument but got 0

using Bar[Int] = new Bar

:e
:re
foo
//│ ╔══[ERROR] Cannot query instance of type ‹unspecified› (type parameter A) for call: 
//│ ║  l.115: 	foo
//│ ║         	^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.69: 	fun foo[A](using A)(using Foo[A]) = 42
//│ ║        	                 ^
//│ ╙── Illegal query for an unspecified type variable A.
//│ ═══[RUNTIME ERROR] Error: Function 'foo' expected 1 argument but got 0

using Bar[Baz] = new Bar

:todo
foo
//│ ╔══[ERROR] Cannot query instance of type ‹unspecified› (type parameter A) for call: 
//│ ║  l.128: 	foo
//│ ║         	^^^
//│ ╟── Required by contextual parameter declaration: 
//│ ║  l.69: 	fun foo[A](using A)(using Foo[A]) = 42
//│ ║        	                 ^
//│ ╙── Illegal query for an unspecified type variable A.
//│ ═══[RUNTIME ERROR] Error: Function 'foo' expected 1 argument but got 0


